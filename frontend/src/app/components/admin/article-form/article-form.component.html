<div class="container mt-4">
  <h1>{{ isEditMode ? 'Modifier l\'article' : 'Nouvel article' }}</h1>

  <div class="alert alert-danger" *ngIf="error">
    {{ error }}
  </div>

  <form [formGroup]="articleForm" (ngSubmit)="onSubmit()" class="mt-4">
    <div class="mb-3">
      <label for="name" class="form-label">Nom</label>
      <input
        type="text"
        class="form-control"
        id="name"
        formControlName="name"
        [ngClass]="{'is-invalid': articleForm.get('name')?.invalid && articleForm.get('name')?.touched}"
      >
      <div class="invalid-feedback" *ngIf="articleForm.get('name')?.errors?.['required']">
        Le nom est requis
      </div>
      <div class="invalid-feedback" *ngIf="articleForm.get('name')?.errors?.['minlength']">
        Le nom doit contenir au moins 3 caractères
      </div>
    </div>

    <div class="mb-3">
      <label for="description" class="form-label">Description</label>
      <textarea
        class="form-control"
        id="description"
        formControlName="description"
        rows="3"
        [ngClass]="{'is-invalid': articleForm.get('description')?.invalid && articleForm.get('description')?.touched}"
      ></textarea>
      <div class="invalid-feedback" *ngIf="articleForm.get('description')?.errors?.['required']">
        La description est requise
      </div>
      <div class="invalid-feedback" *ngIf="articleForm.get('description')?.errors?.['minlength']">
        La description doit contenir au moins 10 caractères
      </div>
    </div>

    <div class="mb-3">
      <label for="price" class="form-label">Prix</label>
      <div class="input-group">
        <input
          type="number"
          class="form-control"
          id="price"
          formControlName="price"
          step="0.01"
          [ngClass]="{'is-invalid': articleForm.get('price')?.invalid && articleForm.get('price')?.touched}"
        >
        <span class="input-group-text">€</span>
      </div>
      <div class="invalid-feedback" *ngIf="articleForm.get('price')?.errors?.['required']">
        Le prix est requis
      </div>
      <div class="invalid-feedback" *ngIf="articleForm.get('price')?.errors?.['min']">
        Le prix doit être supérieur à 0
      </div>
    </div>

    <div class="mb-3">
      <label for="category" class="form-label">Catégorie</label>
      <select
        class="form-select"
        id="category"
        formControlName="category"
        [ngClass]="{'is-invalid': articleForm.get('category')?.invalid && articleForm.get('category')?.touched}"
      >
        <option value="">Sélectionnez une catégorie</option>
        <option value="Cake">Cake</option>
        <option value="Bread">Bread</option>
        <option value="Pastry">Pastry</option>
        <option value="Viennoiserie">Viennoiserie</option>
      </select>
      <div class="invalid-feedback" *ngIf="articleForm.get('category')?.errors?.['required']">
        La catégorie est requise
      </div>
    </div>

    <div class="mb-3">
      <label for="image" class="form-label">Image</label>
<input type="file" class="form-control" id="image" accept="image/*" (change)="onFileChange($event)">

    </div>

    <div class="d-flex justify-content-between">
      <button type="button" class="btn btn-secondary" (click)="router.navigate(['/admin/articles'])">
        Annuler
      </button>
      <button type="submit" class="btn btn-primary" [disabled]="articleForm.invalid">
        {{ isEditMode ? 'Mettre à jour' : 'Créer' }}
      </button>
    </div>
  </form>
</div> 
